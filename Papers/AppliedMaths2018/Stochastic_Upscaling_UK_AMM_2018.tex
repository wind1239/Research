
% Copyright 2007, 2008, 2009 Elsevier Ltd 
% 
% This file is part of the 'Elsarticle Bundle'.
% --------------------------------------------- 
%
% It may be distributed under the conditions of the LaTeX Project Public
% License, either version 1.2 of this license or (at your option) any
% later version.  The latest version of this license is in
%    http://www.latex-project.org/lppl.txt
% and version 1.2 or later is part of all distributions of LaTeX
% version 1999/12/01 or later c.
%
% The list of all files belonging to the 'Elsarticle Bundle' is
% given in the file `manifest.txt'.
%
 
% Template article for Elsevier's document class `elsarticle'
% with harvard style bibliographic references
% SP 2008/03/01
%
%
%
% $Id: elsarticle-template-harv.tex 4 2009-10-24 08:22:58Z rishi $
%
%
%\documentclass[preprint,authoryear,12pt]{elsarticle}
\documentclass[preprint,12pt]{elsarticle}

% Use the option review to obtain double line spacing
%\documentclass[authoryear,preprint,review,12pt]{elsarticle}

% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
% for a journal layout:
%\documentclass[final,authoryear,1p,times]{elsarticle}
%\documentclass[final,authoryear,1p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,3p,times]{elsarticle}
%\documentclass[final,authoryear,3p,times,twocolumn]{elsarticle}
%\documentclass[final,authoryear,5p,times]{elsarticle}
%\documentclass[final,authoryear,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the gra

%%graphis package for simple commands
%% \usepackage{graphics}
%\usepackage{cases}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
\usepackage{epsfig}
%\usepackage{subfig}
\usepackage{comment}

\usepackage{epstopdf}
\usepackage{pdflscape}
\usepackage{bm}
\usepackage{hyperref,url}
\hypersetup{colorlinks=true, urlcolor=blue, linkcolor=blue, citecolor=red}

%% The amssymb package provides various useful mathematical symbols

\usepackage{amssymb,amsmath,array}
%The amsthm package provides extended theorem environments

\usepackage{amsthm}
\usepackage{graphicx}
%\usepackage{subfigure}
  
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

\usepackage{lscape}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon (default)
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   authoryear - selects author-year citations (default)
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%   longnamesfirst  -  makes first citation full author list
%%
%% \biboptions{longnamesfirst,comma}

% \biboptions{}

\newcommand{\JGnote}[1]{\fbox{\parbox{\textwidth}{ \color{red} JG Note $\Rightarrow$ #1}}}
\newcommand{\KCnote}[1]{\fbox{\parbox{\textwidth}{ \color{black} KC Note $\Rightarrow$ #1}}}
\newcommand{\red}{\textcolor{red}}
\newcommand{\blue}{\textcolor{blue}}
\newcommand{\green}{\textcolor{green}}
\newcommand{\frc}{\displaystyle\frac}
\newcommand{\PN}[2][error]{P$_{#1}$DG-P$_{#2}$}
\newcommand{\PNDG}[2][error]{P$_{#1}$DG-P$_{#2}$DG}
\newcommand{\eg}{{\it e.g., }} 
\newcommand{\ie}{{\it i.e., }}

\journal{Applied Mathematical Modelling}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}} 
%% \fntext[label3]{}

\title{A Reduced Order Model for Permeability Fields Using Singular Value Decomposition, SVD, by Interpolating in the Principal Component Spaces}
\author[UoA]{B. Lashore\corref{cor1}}\ead{lashorebabatunde@yahoo.com} \author[UoA]{J.L.M.A. Gomes} \author[UoA]{K. Christou}
\cortext[cor1]{Corresponding author.}
\address[UoA]{Mechanics of Fluids, Soils \& Structures Group, School of Engineering, University of Aberdeen, UK}


\begin{abstract}
  BlaBlaBlah Nice Abstract 
\end{abstract}



\begin{keyword} %% keywords here, in the form: keyword \sep keyword
Singular Value Decomposition, SVD\sep Upscaling\sep Model Order Reduction, MOD \sep  Principal Component Spaces \sep Permeability field
\end{keyword}
 
\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\section{Introduction}\label{section:intro}
Naturally occuring rock formations are inherently heterogeneous, which means that the rock properties such as permeability, pore spaces ({\it i.e.}, porosity) and pore throat vary from point to point, and at different length scales. The heterogeneity of rock formations (studied under the general title of porous media) is relevant in calculations required for understanding transportation and storage of fluids in porous media. This is because the heterogeneous properties are important parameters in the mathematical models used for the aforementioned calculations. Therefore, the representation of these heterogeneous properties is of great importance to the porous media and applied mathematics community as well as the oil and gas industry, the Carbon Capture and Storage (CCS) industry, and waste management industry for whom this has direct application in reservoir management, CO$_2$ transportation and storage in subsurface rocks and remediation of contaminated soil respectively.

Furthermore, due to limitations in computing resources, for simulations with very fine grids it is neither efficient nor possible to obtain exact values of geological properties at all points in the domain (\ie scale problems) \cite{Renard_1997} \cite{miller_1998} \cite{chen_2006}. This is particularly true for large geological domains which span several kilometres. Additionally, it is not possible to obtain reliable and accurate spatial information about geological properties throughout the domain ({\it i.e.}, uncertainty problems). It is possible to overcome these challenges by upscaling. Upscaling techniques solve both problems by replacing discrete geological and fluid property values of detailed high resolution domains with coarse descriptions (low resolution) of these properties \cite{Vereecken_2007}. And upscaling techniques which best preserve the statistical properties and flow dynamics behaviour of the high resolution domain gives the best representation of the heterogeneous property.

There are several upscaling techniques which fall under different categories \cite{Renard_1997, Szymkiewicz_2013, Hasting_2001}, however over the last decade, techniques classed as stochastic have received great attention from academic and industrial porous media communities worldwide \cite{Verwoerd_2009, Ravalec-Dupin_2010, Guilleminot_2012}. One of the reasons for this is because stochastic techniques are robust enough to handle multiphase flow in porous media, and they address scale and uncertainity problems which were previously mentioned.

This work couples stochastic and deterministic upscaling representations of the permeability field to a novel high-order accurate control volume finite element method (CVFEM) (see \cite{Gomes_2017} for further details of the model formulation) so as to investigate statistical properties and multiphase flow behaviour in highly heterogeneous porous media. 

Four upscaling techniques are investigated in this research. The arithmetic and harmonic mean are used to obtain the first two upscaled representation and these two are classed as deterministic techniques. The third is a randomly generated permeability field with a Guassian distribution, prescribed by a probability density function (PDF) which was obtained from a base case ({\it i.e.}, high-resolution mesh with known permeability distribution). The four upscaling technique is the crux of this research, it introduces singular value decomposition (SVD) as a method of upscaling using interpolation within the concept of principal component space to reduce the order of the permeability field.

In section 2, the basic mathematical explanation of SVD and its associated linear algebra properties are presented. The the concept of spaces is explained from the engineer's perspective and also from the mathematician's perspective. The objective of this explanation is to assist both parties in visualizing the relevant spaces and performing the necessary transformation within those spaces. Finally, the section describes model order space reduction for the permeability field within the principal component space. Section 3, starts by describing the high resolution base case on which the four upscaling techniques are modelled. The the simulation run which is similar for all the cases/models is described. A brief summary of the pre-processing step for each of the models is also presented. Section 4 provides the results and some discussion on the results of the simulations. It als gives further intepretation to the result obtained from the SVD upscaling technique. Finally, section 5 provides the conclusion.


\section{Singular Value Decomposition, SVD, and its application for reducing the order of a permeability field}\label{section:svd}
\subsection{A Brief Introduction to SVD}\label{subsection:svd_brief}

Singular Value Decomposition, SVD, exists within the linear algebra branch of mathematics as one of the most exciting means of factorizing a matrix, $\mathbf{A}$, into three parts $\mathbf{U}$, $\Sigma$ and $\mathbf{V}$. Where $\mathbf{U}$ and $\mathbf{V}$ are orthonormal, and $\Sigma$ is a diagonal matrix. If $\mathbf{A}$, is a square matrix then $\mathbf{U}$, $\Sigma$ and $\mathbf{V}$ are square matrix and $\mathbf{U}^{\intercal}\mathbf{U} = \mathbf{V}^{\intercal}\mathbf{V} = \mathbf{I}$. But if $\mathbf{A}$ is an $m * n$ matrix, $\mathbf{U}$ and $\mathbf{V}$ still remain as square matrices, albeit with different matricial sizes. $\mathbf{U}$ is an $m * m$ while $\mathbf{V}$ is an $n * n$. Another interesting property of $\mathbf{U}$ and $\mathbf{V}$ since they are square (irrespective of whether A is square or rectangular) is that $\mathbf{U}^{-1} = \mathbf{U}^{\intercal}$ and $\mathbf{V}^{-1} = \mathbf{V}^{\intercal}$. When $\mathbf{A}$ is an $m * n$ matrix, $\Sigma$ is a diagonal $m x n$ matrix. The diagonal entries of $\Sigma$ (in both the case of square and rectangular matrices) are referred to as the singular values of $\mathbf{A}$, and are usually denoted by sigma ($\sigma_{1}, \sigma_{2},..., \sigma_{r}$). For a rectangular matrix, the singular values fill the first $r$ places on the main diagonal of $\Sigma$, where $r$ is the rank of A. Additionally, the $i$th singular value, $\sigma_{i}$ is ordered such that $\sigma_{1} \geq \sigma_{2} \geq ...\geq \sigma_{r}$. A huge benefit of the SVD is the orthogonality of the columns in $\mathbf{U}$ and $\mathbf{V}$. The columns of $\mathbf{U}$ are known as the left singular vectors while the columns in $\mathbf{V}$ are known as the right singular vectors. A simple consideration of the benefit of this, is the ease with which it allows the inverse of square matrix $\mathbf{A}$ to be calculated. This example is presented thus:

\begin{equation}
 \mathbf{A}x = b
\end{equation}
\begin{equation}
 \mathbf{U} \Sigma \mathbf{V}^{\intercal} x = b
\end{equation}
\begin{equation}
 x = \mathbf{V} \Sigma^{-1} \mathbf{U}^{\intercal} b
\end{equation}

\subsection{Principal Component Spaces and Model Order Reduction for the permeability field}\label{subsection:pcspaces}

\subsubsection{Visualizing the permeability space}\label{subsubsection:visualization_permspace}
In real-life ({\it i.e.}, a 3D geometry), permeability is a tensor quantity, but for the purpose of the following explanation (and the remaining part of this paper), a 2D geometry is assumed where permeability is a scalar quantity. Furthermore, the simulator prescribes the permeability field using $P0DG$ element type, which means that permeability values are assigned in the middle node of the triangular unstructured mesh used for discretizing the 2D simulation geometry. And the value assigned in the middle node of the triangle represents the permeability value for the whole triangular element. But for simplicity, in the remaining part of this section, we will imagine or assume the $2D$ geometry is discritized by a square grid with the value for each square element assigned in the middle of the element. This explanation allow one to easily visualize this permeability space because it is defined by the $x,y$ co-ordinates  system which most people are already familiar with. The model order reduction for the permeability field discussed here is concerned with reducing the volume of permeability data within the permeability space. Consider for instance a small square which is discretized to contain four squares such that $4$ data values are defined in the middle of the four squares. The permeability space of $4$ can be reduced to a smaller value of $1$ through an averaging process such as arithmetic, harmonic or geometric mean. This type of reduction is the focus of this paper, albeit the main focus of this paper is achieving this reduction through singular value decomposition in the principal component spaces. 

\subsubsection{Visualizing the principal component spaces}\label{subsubsection:visualization_pcspaces}
Essentially, the existing permeability space is transformed through SVD to principal component spaces where usually, traditional principal component analysis is performed before interpolation is used to implement further data reduction in the principal component spaces. This reduced data in the principal component space is then transformed back into the permeability space to obtain a reduced permeability space.

The principal component space is a bit more challenging to visualize because it usually consists of more than $3$ dimensions. $3D$ ({\it i.e.}, $x, y$ and $z$ in the cartesian plane) being the natural dimension which humans exist, is easy to visualize. Many engineers are also able to visualize 4D with time as the fourth dimension, albeit only few scientists and engineers are able to visualize and work in the abstract dimension where the number of dimensions exceed four. An aid for visualizing the PC space is to write out the $\mathbf{U}$, $\mathbf{\Sigma}$ and $\mathbf{V^{\intercal}}$ matrices (or imagine the matrices written out) and consider the singular vectors ({\it i.e.},columns in $\mathbf{U}$ and rows in $\mathbf{U}$) as separate principal component spaces.

\subsubsection{Model Order Reduction/Principal Component Space Reduction}\label{subsubsection:svdcase_preprocess_algorithm}
 For the SVD model order reduction of the permeability field, all the work is done in the principal component spaces. This can be completed in two steps. The first step is optional and it is the well known principal component analysis (PCA). Here, the singular values are examined and based on a pre-defined criteria, z singular values are selected, starting from $\sigma_{1}$ and in a decreasing order. $z \leq r$, where in the case $z = r$, it can be assumed that step 1 has been ignored. In the case where $z < r$, the first z columns of $\mathbf{U}$ and the first z rows of $\mathbf{V^{\intercal}}$ are extracted from $\mathbf{U}$ and $\mathbf{V^{\intercal}}$ to form new matrices $\mathbf{U_{new}}$ and $\mathbf{V^{\intercal}_{new}}$ respectively. The selected z singular values also for a new diagonal matrix ({\it i.e.}, where $z < r$).

The second step involves interpolation within each singular vector (column in $\mathbf{U}$ and row in $\mathbf{V^{\intercal}}$), to reduce the number of data in each column of  $\mathbf{U}$ and in $\mathbf{V^{\intercal}}$. From this step,  $\mathbf{U_{new2}}$ and $\mathbf{V^{\intercal}_{new2}}$ are obtained. The reduced permeability field is calculated by multiplying  $\mathbf{U_{new2}}$ $\mathbf{\Sigma_{new}}$ and $\mathbf{V^{\intercal}_{new2}}$. 

\section{Model Description and Simulation Setup}\label{section:model_simulation}
blah blah about geology
\\
\\
\\
\\
\\
\\

\subsection{Model Description}\label{subsection:model}
The model for the permeabiliy field builds on the $2 * 2$ block, $4$ quadrant model used by 
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\ 

Four upscaled models were obtained from a base case which is a high-resolution permeability field with a known permeability distribution. The base case consists of four regions, where each region is uniformly randomly generated within a specified range. 


\subsubsection{BaseCase Pre-processing Algorithm}\label{subsubsection:basecase_preprocess_algorithm}
\begin{enumerate}[1]
  \item A function is used to randomly generate uniform ({\it i.e.} Gaussian) data for each block. The range for each block is as below:
  \begin{enumerate}[a]
    \item \textbf{K1} :
    \item \textbf{K2} :
    \item \textbf{K3} :
    \item \textbf{K4} : 
  \end{enumerate}                                                    
  \item The number of data generated for each block is $1600$ and the data is randomly position within each block in a structured pattern. Albeit, the simulation grid ({\it i.e.} mesh) is unstructured.
  \item Merge data from different blocks into a single file retaining the original ``structured pattern'' (in step 1 above) for the randomly positioned data in each block. This file will be used by the Control Volume Finite Element Method (CVFEM) simulator to prescribe the permeability field for the base case.
\end{enumerate}


\subsubsection{PDFCase Pre-processing Algorithm}\label{subsubsection:pdfcase_preprocess_algorithm}
\begin{enumerate}[1]
  \item Data from step one of the pre-processing algorithm for the base case is used to calculate the mean and standard deviation for each block of the permeability field.
  \item A function which generates a Gaussian data set using arithmetic mean and standard deviation is used to stochastically produce a quater of the number of data in the base case for each of the four blocks.
  \item The number of data generated for each block is $400$ and the data is randomly position within each block in a structured pattern. As in the base case, the simulation grid ({\it i.e.} mesh) is unstructured.
  \item Finally, the structured data from each block is combined into a single file and then provided to the CVFEM simulator.
\end{enumerate}


\subsubsection{SVDCase Pre-processing Algorithm}\label{subsubsection:svdcase_preprocess_algorithm}
\begin{enumerate}[1]
  \item The permeability field obtained in step 3 of the pre-processing algorithm for the base case is factorized using SVD to obtain $\mathbf{U}, \Sigma,$ and $\mathbf{V}$.
  \item A selected number, $z$, of singular values are retained in decreasing order of magnitude to form a new diagonal matrix, $\Sigma_{new}$.
  \item The first $z$ columns of $\mathbf{U}$ and $\mathbf{V}$ are selected to form new truncated matrices call $\mathbf{U_{new}}$ and $\mathbf{V_{new}}$ respectively.
  \item Within each column of $\mathbf{U}$ and $\mathbf{V}$ a linear interpolation is performed to form a new column with the number of data in each column reduced to a half of the original column. And, these new columns are recombined to form $\mathbf{U_{new2}}$ and $\mathbf{V_{new2}}$.
  \item The permeability field used for the SVD case is the matrix, $\mathbf{A_{new2}}$ which is defined as $\mathbf{U_{new2}} \mathbf{\Sigma_{new}} \mathbf{V_{new2}^{\intercal}}$. It is a permeability field with a quater of the data in the base cased and therefore a permeability field with a reduced order.  
\end{enumerate}

\subsection{Simulations}\label{subsection:simulations}
For the simulations, each of the model's domain is initially fully saturated with a fluid (Phase 2), and a wetting phase (1) fluid is driven into the domain from the left hand side at a constant mass flow rate. Newmann ({\it i.e.} no flux) boundary conditions were imposed on the upper and lower borders of each domain, while mixed fluids are recovered from the right-hand face. Fig (...........)a shows the permeability field of the base case while fig (....... - ........) shows the phase saturation field during fluid injection for time, $t = 0.15s, 0.30s, 0.50s, 1.15s, 1.75s$ and $2.95s$.

\section{Results and Discussion}\label{section:results_discussion}

Where are them beautiful screenshots!\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\

\section{Conclusion}\label{section:conclusion}

Conclude man!\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\
\\



%\section{Acknowledgements}
%Mr William Rad\"unz would like to acknowledge the support from the Brazilian Research Council (CNPq) under the \textit{Science without Borders scholarship programme}. Mr Konstantinos Christou would like to acknowledge the support of the University of Aberdeen - College of Physical Science as well as the Aberdeen Formation Evaluation Society (\textit{AFES} is an SPWLA chapter). 

\clearpage 
%% References with bibTeX database:
\bibliographystyle{elsarticle-harv} 
%\bibliographystyle{elsarticle-num}
%\bibliographystyle{apacite}
\bibliography{references}
  
\clearpage 

\listoftables
\clearpage
%\input{article_table}
\clearpage  
\listoffigures
\clearpage
\input{article_figure1} 

\end{document}
%% End of tex file.


